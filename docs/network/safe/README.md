# 前端安全

## xss(cross site scripting)跨站脚本攻击

它是一种代码注入攻击，攻击者在目标网站上注入恶意脚本，使之在用户的浏览器上运行，获取用户隐私数据或敏感信息等。本质是恶意代码未经过滤，与网站的正常代码混到了一起被执行

最常见的注入方式是来自用户输入的信息，也可以来自第三方链接，url 参数等

根据攻击的来源，xss 攻击可分为三类：存储型、反射型和 DOM 型

##### 存储型

攻击者将恶意代码提交到目标网站的数据库中，普通用户浏览目标网站，恶意代码从服务端返回并执行

这种攻击常见于带有用户保存数据功能的网站，比如论坛发帖，输入商品评论等

##### 反射型

攻击者构造一段包含恶意代码的特殊 URL，用户点击，服务端将恶意代码取出拼接到 HTML 中返回，浏览器解析，恶意代码被执行。反射型 XSS 漏洞常见于通过 url 传递参数的功能，比如网站搜索

这种攻击需要用户主动打开恶意链接才能生效，因此攻击者会使用多种手段诱导用户点击

##### DOM 型

攻击者构造一段包含恶意代码的特殊 URL，用户点击，前端取出 URL 中的恶意代码并执行，DOM 型的 XSS 攻击不经过服务端，属于前端的安全漏洞

##### 防御手段

- 输入过滤。对用户输入内容进行检查和过滤，转义其中的<>等特殊字符，也可以使用白名单机制。
- 前端应该避免使用 .innerHTML、document.write() 等方法，避免把不可信的数据直接插到页面上
- DOM 中的内联事件监听器比如 onload，onerror，a 标签的 href 属性等都能把字符串作为代码运行，应尽量避免
- 在使用现代前端框架时，我们需要避免使用 v-html 和 dangerouslySetInnerHTML 等 api
- 为 cookie 设置 httponly 属性，禁止客户端脚本读取 cookie
- 使用 CSP

## CSRF 跨站请求伪造

攻击者诱导普通用户进入第三方网站，在第三方网站中向目标网站发送跨站请求，利用普通用户已经在目标网站获取的认证凭证(通常是 cookie)，达到冒充用户对目标网站执行某项操作的目的

跨站请求有多种方式，图片 URL，超链接，表单提交等

##### 特点

- 它需要用户提前登录
- CSRF 攻击是冒充用户身份对目标网站提交操作，而不是直接窃取数据
- 无法获得用户的登录凭证，仅仅是冒用

##### 防御手段

- 验证 Referer 请求头
- 前端页面添加验证码
- 验证 token
- 为 cookie 设置 same-site 属性，禁止携带第三方 cookie
